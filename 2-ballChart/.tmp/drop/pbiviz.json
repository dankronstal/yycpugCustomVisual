{"visual":{"name":"barChartSampleModified","displayName":"BarChartSampleModified","guid":"PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG","visualClassName":"Visual","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"apiVersion":"1.1.0","author":{"name":"","email":""},"assets":{"icon":"assets/icon.png"},"externalJS":[],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Category Data","name":"category","kind":0},{"displayName":"Measure Data","name":"measure","kind":1}],"dataViewMappings":[{"conditions":[{"category":{"max":1},"measure":{"max":1}}],"categorical":{"categories":{"for":{"in":"category"}},"values":{"select":[{"bind":{"to":"measure"}}]}}}],"objects":{"enableAxis":{"displayName":"Enable Axis","properties":{"show":{"displayName":"Enable Axis","type":{"bool":true}}}},"colorSelector":{"displayName":"Data Colors","properties":{"fill":{"displayName":"Color","type":{"fill":{"solid":{"color":true}}}}}}}},"content":{"js":"/*\r\n *  Power BI Visual CLI\r\n *\r\n *  Copyright (c) Microsoft Corporation\r\n *  All rights reserved.\r\n *  MIT License\r\n *\r\n *  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n *  of this software and associated documentation files (the \"\"Software\"\"), to deal\r\n *  in the Software without restriction, including without limitation the rights\r\n *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n *  copies of the Software, and to permit persons to whom the Software is\r\n *  furnished to do so, subject to the following conditions:\r\n *\r\n *  The above copyright notice and this permission notice shall be included in\r\n *  all copies or substantial portions of the Software.\r\n *\r\n *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n *  THE SOFTWARE.\r\n */\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            var PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2;\r\n            (function (PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2) {\r\n                ;\r\n                ;\r\n                /**\r\n                 * Function that converts queried data into a view model that will be used by the visual.\r\n                 *\r\n                 * @function\r\n                 * @param {VisualUpdateOptions} options - Contains references to the size of the container\r\n                 *                                        and the dataView which contains all the data\r\n                 *                                        the visual had queried.\r\n                 * @param {IVisualHost} host            - Contains references to the host which contains services\r\n                 */\r\n                function visualTransform(options, host) {\r\n                    var dataViews = options.dataViews;\r\n                    var defaultSettings = {\r\n                        enableAxis: {\r\n                            show: false,\r\n                        }\r\n                    };\r\n                    var viewModel = {\r\n                        dataPoints: [],\r\n                        dataMax: 0,\r\n                        settings: {}\r\n                    };\r\n                    if (!dataViews\r\n                        || !dataViews[0]\r\n                        || !dataViews[0].categorical\r\n                        || !dataViews[0].categorical.categories\r\n                        || !dataViews[0].categorical.categories[0].source\r\n                        || !dataViews[0].categorical.values)\r\n                        return viewModel;\r\n                    var categorical = dataViews[0].categorical;\r\n                    var category = categorical.categories[0];\r\n                    var dataValue = categorical.values[0];\r\n                    var ballChartDataPoints = [];\r\n                    var dataMax;\r\n                    var colorPalette = PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.createColorPalette(host.colors).reset();\r\n                    var objects = dataViews[0].metadata.objects;\r\n                    var ballChartSettings = {\r\n                        enableAxis: {\r\n                            show: PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getValue(objects, 'enableAxis', 'show', defaultSettings.enableAxis.show),\r\n                        }\r\n                    };\r\n                    for (var i = 0, len = Math.max(category.values.length, dataValue.values.length); i < len; i++) {\r\n                        var defaultColor = {\r\n                            solid: {\r\n                                color: colorPalette.getColor(category.values[i]).value\r\n                            }\r\n                        };\r\n                        ballChartDataPoints.push({\r\n                            category: category.values[i],\r\n                            value: dataValue.values[i],\r\n                            color: PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getCategoricalObjectValue(category, i, 'colorSelector', 'fill', defaultColor).solid.color,\r\n                            selectionId: host.createSelectionIdBuilder()\r\n                                .withCategory(category, i)\r\n                                .createSelectionId()\r\n                        });\r\n                    }\r\n                    dataMax = dataValue.maxLocal;\r\n                    return {\r\n                        dataPoints: ballChartDataPoints,\r\n                        dataMax: dataMax,\r\n                        settings: ballChartSettings,\r\n                    };\r\n                }\r\n                var Visual = (function () {\r\n                    /**\r\n                     * Creates instance of ballChart. This method is only called once.\r\n                     *\r\n                     * @constructor\r\n                     * @param {VisualConstructorOptions} options - Contains references to the element that will\r\n                     *                                             contain the visual and a reference to the host\r\n                     *                                             which contains services.\r\n                     */\r\n                    function Visual(options) {\r\n                        this.host = options.host;\r\n                        this.selectionManager = options.host.createSelectionManager();\r\n                        var svg = this.svg = d3.select(options.element)\r\n                            .append('svg')\r\n                            .classed('ballChart', true);\r\n                        this.ballContainer = svg.append('g')\r\n                            .classed('ballContainer', true);\r\n                        this.xAxis = svg.append('g')\r\n                            .classed('xAxis', true);\r\n                    }\r\n                    /**\r\n                     * Updates the state of the visual. Every sequential databinding and resize will call update.\r\n                     *\r\n                     * @function\r\n                     * @param {VisualUpdateOptions} options - Contains references to the size of the container\r\n                     *                                        and the dataView which contains all the data\r\n                     *                                        the visual had queried.\r\n                     */\r\n                    Visual.prototype.update = function (options) {\r\n                        var viewModel = visualTransform(options, this.host);\r\n                        var settings = this.ballChartSettings = viewModel.settings;\r\n                        this.ballDataPoints = viewModel.dataPoints;\r\n                        var width = options.viewport.width;\r\n                        var height = options.viewport.height;\r\n                        this.svg.attr({\r\n                            width: width,\r\n                            height: height\r\n                        });\r\n                        if (settings.enableAxis.show) {\r\n                            var margins = Visual.Config.margins;\r\n                            height -= margins.bottom;\r\n                        }\r\n                        this.xAxis.style({\r\n                            'font-size': d3.min([height, width]) * Visual.Config.xAxisFontMultiplier,\r\n                        });\r\n                        var yScale = d3.scale.linear()\r\n                            .domain([0, viewModel.dataMax])\r\n                            .range([height, 0]);\r\n                        var xScale = d3.scale.ordinal()\r\n                            .domain(viewModel.dataPoints.map(function (d) { return d.category; }))\r\n                            .rangeRoundBands([0, width], Visual.Config.xScalePadding, 0.2);\r\n                        var xAxis = d3.svg.axis()\r\n                            .scale(xScale)\r\n                            .orient('bottom');\r\n                        this.xAxis.attr('transform', 'translate(0, ' + height + ')')\r\n                            .call(xAxis);\r\n                        var ball = this.ballContainer.selectAll('.ball').data(viewModel.dataPoints);\r\n                        ball.enter()\r\n                            .append('circle')\r\n                            .classed('ball', true);\r\n                        ball.attr({\r\n                            cy: function (d) { return 200; },\r\n                            cx: function (d) { return 100 + xScale(d.category); },\r\n                            r: function (d) { return (height - yScale(d.value)) / 4; },\r\n                            fill: function (d) { return d.color; },\r\n                            'fill-opacity': Visual.Config.solidOpacity,\r\n                        });\r\n                        var selectionManager = this.selectionManager;\r\n                        //This must be an anonymous function instead of a lambda because\r\n                        //d3 uses 'this' as the reference to the element that was clicked.\r\n                        ball.on('click', function (d) {\r\n                            var _this = this;\r\n                            selectionManager.select(d.selectionId).then(function (ids) {\r\n                                ball.attr({\r\n                                    'fill-opacity': ids.length > 0 ? Visual.Config.transparentOpacity : Visual.Config.solidOpacity\r\n                                });\r\n                                d3.select(_this).attr({\r\n                                    'fill-opacity': Visual.Config.solidOpacity\r\n                                });\r\n                            });\r\n                            d3.event.stopPropagation();\r\n                        });\r\n                        ball.exit()\r\n                            .remove();\r\n                    };\r\n                    /**\r\n                     * Enumerates through the objects defined in the capabilities and adds the properties to the format pane\r\n                     *\r\n                     * @function\r\n                     * @param {EnumerateVisualObjectInstancesOptions} options - Map of defined objects\r\n                     */\r\n                    Visual.prototype.enumerateObjectInstances = function (options) {\r\n                        var objectName = options.objectName;\r\n                        var objectEnumeration = [];\r\n                        switch (objectName) {\r\n                            case 'enableAxis':\r\n                                objectEnumeration.push({\r\n                                    objectName: objectName,\r\n                                    properties: {\r\n                                        show: this.ballChartSettings.enableAxis.show,\r\n                                    },\r\n                                    selector: null\r\n                                });\r\n                                break;\r\n                            case 'colorSelector':\r\n                                for (var _i = 0, _a = this.ballDataPoints; _i < _a.length; _i++) {\r\n                                    var ballDataPoint = _a[_i];\r\n                                    objectEnumeration.push({\r\n                                        objectName: objectName,\r\n                                        displayName: ballDataPoint.category,\r\n                                        properties: {\r\n                                            fill: {\r\n                                                solid: {\r\n                                                    color: ballDataPoint.color\r\n                                                }\r\n                                            }\r\n                                        },\r\n                                        selector: ballDataPoint.selectionId.getSelector()\r\n                                    });\r\n                                }\r\n                                break;\r\n                        }\r\n                        ;\r\n                        return objectEnumeration;\r\n                    };\r\n                    /**\r\n                     * Destroy runs when the visual is removed. Any cleanup that the visual needs to\r\n                     * do should be done here.\r\n                     *\r\n                     * @function\r\n                     */\r\n                    Visual.prototype.destroy = function () {\r\n                        //Perform any cleanup tasks here\r\n                    };\r\n                    Visual.Config = {\r\n                        xScalePadding: 0.1,\r\n                        solidOpacity: 1,\r\n                        transparentOpacity: 0.5,\r\n                        margins: {\r\n                            top: 0,\r\n                            right: 0,\r\n                            bottom: 25,\r\n                            left: 30,\r\n                        },\r\n                        xAxisFontMultiplier: 0.04,\r\n                    };\r\n                    return Visual;\r\n                }());\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.Visual = Visual;\r\n            })(PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 || (visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = {}));\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            var PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2;\r\n            (function (PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2) {\r\n                /**\r\n                 * Singleton reference of ColorPalette.\r\n                 *\r\n                 * @instance\r\n                 */\r\n                var colorManager;\r\n                /**\r\n                 * Factory method for creating a ColorPalette.\r\n                 *\r\n                 * @function\r\n                 * @param {IColorInfo[]} colors - Array of ColorInfo objects that contain\r\n                 *                                hex values for colors.\r\n                 */\r\n                function createColorPalette(colors) {\r\n                    if (!colorManager)\r\n                        colorManager = new ColorPalette(colors);\r\n                    return colorManager;\r\n                }\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.createColorPalette = createColorPalette;\r\n                var ColorPalette = (function () {\r\n                    function ColorPalette(colors) {\r\n                        this.colorPalette = {};\r\n                        this.colorIndex = 0;\r\n                        this.colors = colors;\r\n                    }\r\n                    /**\r\n                     * Gets color from colorPalette and returns an IColorInfo\r\n                     *\r\n                     * @function\r\n                     * @param {string} key - Key of assign color in colorPalette.\r\n                     */\r\n                    ColorPalette.prototype.getColor = function (key) {\r\n                        var color = this.colorPalette[key];\r\n                        if (color) {\r\n                            return color;\r\n                        }\r\n                        var colors = this.colors;\r\n                        color = this.colorPalette[key] = colors[this.colorIndex++];\r\n                        if (this.colorIndex >= colors.length) {\r\n                            this.colorIndex = 0;\r\n                        }\r\n                        return color;\r\n                    };\r\n                    /**\r\n                     * resets colorIndex to 0\r\n                     *\r\n                     * @function\r\n                     */\r\n                    ColorPalette.prototype.reset = function () {\r\n                        this.colorIndex = 0;\r\n                        return this;\r\n                    };\r\n                    /**\r\n                     * Clears colorPalette of cached keys and colors\r\n                     *\r\n                     * @function\r\n                     */\r\n                    ColorPalette.prototype.clear = function () {\r\n                        this.colorPalette = {};\r\n                    };\r\n                    return ColorPalette;\r\n                }());\r\n            })(PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 || (visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = {}));\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            var PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2;\r\n            (function (PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2) {\r\n                /**\r\n                 * Gets property value for a particular object.\r\n                 *\r\n                 * @function\r\n                 * @param {DataViewObjects} objects - Map of defined objects.\r\n                 * @param {string} objectName       - Name of desired object.\r\n                 * @param {string} propertyName     - Name of desired property.\r\n                 * @param {T} defaultValue          - Default value of desired property.\r\n                 */\r\n                function getValue(objects, objectName, propertyName, defaultValue) {\r\n                    if (objects) {\r\n                        var object = objects[objectName];\r\n                        if (object) {\r\n                            var property = object[propertyName];\r\n                            if (property !== undefined) {\r\n                                return property;\r\n                            }\r\n                        }\r\n                    }\r\n                    return defaultValue;\r\n                }\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getValue = getValue;\r\n                /**\r\n                 * Gets property value for a particular object in a category.\r\n                 *\r\n                 * @function\r\n                 * @param {DataViewCategoryColumn} category - List of category objects.\r\n                 * @param {number} index                    - Index of category object.\r\n                 * @param {string} objectName               - Name of desired object.\r\n                 * @param {string} propertyName             - Name of desired property.\r\n                 * @param {T} defaultValue                  - Default value of desired property.\r\n                 */\r\n                function getCategoricalObjectValue(category, index, objectName, propertyName, defaultValue) {\r\n                    var categoryObjects = category.objects;\r\n                    if (categoryObjects) {\r\n                        var categoryObject = categoryObjects[index];\r\n                        if (categoryObject) {\r\n                            var object = categoryObject[objectName];\r\n                            if (object) {\r\n                                var property = object[propertyName];\r\n                                if (property !== undefined) {\r\n                                    return property;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return defaultValue;\r\n                }\r\n                PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.getCategoricalObjectValue = getCategoricalObjectValue;\r\n            })(PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 || (visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2 = {}));\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var visuals;\r\n    (function (visuals) {\r\n        var plugins;\r\n        (function (plugins) {\r\n            plugins.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG = {\r\n                name: 'PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG',\r\n                displayName: 'BarChartSampleModified',\r\n                class: 'Visual',\r\n                version: '1.0.0',\r\n                apiVersion: '1.1.0',\r\n                create: function (options) { return new powerbi.extensibility.visual.PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2.Visual(options); },\r\n                custom: true\r\n            };\r\n        })(plugins = visuals.plugins || (visuals.plugins = {}));\r\n    })(visuals = powerbi.visuals || (powerbi.visuals = {}));\r\n})(powerbi || (powerbi = {}));\r\n//# sourceMappingURL=visual.js.map","css":".visual-PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG p {\n  font-size: 20px;\n  font-weight: bold;\n}\n.visual-PBI_CV_820a1803_8e00_4869_b083_b47eeec8aff2_DEBUG p em {\n  background: yellow;\n  padding: 5px;\n}\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="}}